
// ğŸ”’ SECURITY: åŒå› ç´ è®¤è¯ï¼ˆ2FA/TOTPï¼‰æ¨¡å—
// åŸºäº TOTP (Time-based One-Time Password) æ ‡å‡†
// æ”¯æŒ Google Authenticator / Authy ç­‰åº”ç”¨
model TwoFactorAuth {
  id            String   @id @default(cuid())
  userId        String   @unique // ç”¨æˆ·IDï¼ˆå”¯ä¸€ï¼‰
  secret        String   @db.VarChar(255) // TOTPå¯†é’¥ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰
  recoveryCodes String[] // å¤‡ç”¨æ¢å¤ç ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰
  enabled       Boolean  @default(false) // æ˜¯å¦å¯ç”¨2FA
  verifiedAt    DateTime? // é¦–æ¬¡éªŒè¯æ—¶é—´
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  // å…³ç³»
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@map("two_factor_auth")
}
