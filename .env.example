# ========================================
# Flotilla Environment Variables Template
# ========================================
# ⚠️ IMPORTANT: This is a template file. Copy to .env and fill in real values.
# ⚠️ NEVER commit .env files with real credentials to Git!
#
# Usage:
#   1. Copy this file: cp .env.example .env
#   2. Fill in all values with your actual credentials
#   3. Generate strong secrets using: openssl rand -base64 32
# ========================================

# ========================================
# Database Configuration
# ========================================
# PostgreSQL connection string with connection pool parameters
# Format: postgresql://USERNAME:PASSWORD@HOST:PORT/DATABASE_NAME?param1=value1&param2=value2
#
# Recommended connection pool settings for production:
#   connection_limit=20-50  (number of concurrent connections)
#   pool_timeout=10         (seconds to wait for connection)
#   statement_cache_size=100 (prepared statement cache size)
#
DATABASE_URL="postgresql://USERNAME:PASSWORD@HOST:PORT/DATABASE_NAME?connection_limit=25&pool_timeout=10&statement_cache_size=100"
# Example: postgresql://flotilla:STRONG_PASSWORD_HERE@localhost:5434/flotilla_prod?connection_limit=25&pool_timeout=10
#
# Development (no connection pool params needed):
# DATABASE_URL="postgresql://flotilla:PASSWORD@localhost:5434/flotilla_dev"

# Optional: Database replica for read scaling
DATABASE_REPLICA_URL="postgresql://USERNAME:PASSWORD@HOST:PORT/DATABASE_NAME"

# ========================================
# Redis Configuration
# ========================================
REDIS_URL="redis://:REDIS_PASSWORD@HOST:PORT"
# Example: redis://:STRONG_REDIS_PASSWORD@localhost:6380

# ========================================
# MinIO (S3-Compatible Object Storage)
# ========================================
MINIO_ENDPOINT="localhost"
MINIO_PORT="9000"
MINIO_ACCESS_KEY="YOUR_MINIO_ACCESS_KEY"
MINIO_SECRET_KEY="YOUR_MINIO_SECRET_KEY"
MINIO_USE_SSL="false"  # Set to "true" in production with HTTPS
MINIO_BUCKET_NAME="flotilla-storage"

# ========================================
# MeiliSearch (Full-Text Search Engine)
# ========================================
MEILI_HOST="http://localhost:7700"
# ⚠️ Generate strong key (min 16 chars): openssl rand -base64 24
MEILI_MASTER_KEY="YOUR_MEILISEARCH_MASTER_KEY_MIN_16_CHARS"
MEILI_INDEX_PREFIX="flotilla_"

# ========================================
# JWT (JSON Web Token) Configuration
# ========================================
# ⚠️ CRITICAL: Generate strong secrets using: openssl rand -base64 32
JWT_SECRET="YOUR_JWT_SECRET_256_BITS"
JWT_REFRESH_SECRET="YOUR_JWT_REFRESH_SECRET_256_BITS"
JWT_EXPIRATION="7d"
JWT_REFRESH_EXPIRATION="30d"

# ========================================
# Application Configuration
# ========================================
NODE_ENV="development"  # Options: development | production | test
PORT="4000"

# Frontend & Website URLs (comma-separated for multiple origins)
FRONTEND_URL="http://localhost:3000"
WEBSITE_URL="http://localhost:3003"
# For production multi-domain support, use CORS_ALLOWED_ORIGINS:
# CORS_ALLOWED_ORIGINS="https://app.flotilla.com,https://www.flotilla.com,https://flotilla.com"

# ========================================
# Git Repository Storage
# ========================================
# Path where Git repositories are stored
# Development: Leave empty to use default {cwd}/repos
# Production: MUST set to persistent directory like /var/lib/flotilla/repos
# ⚠️ CRITICAL: Never use temporary directories - data will be lost!
GIT_STORAGE_PATH=""

# ========================================
# Raft Consensus Configuration
# ========================================
RAFT_NODE_ID="node1"
RAFT_CLUSTER_NODES="node1:4000,node2:4001,node3:4002"
RAFT_ELECTION_TIMEOUT_MIN="150"
RAFT_ELECTION_TIMEOUT_MAX="300"
RAFT_HEARTBEAT_INTERVAL="50"

# ========================================
# Bootstrap Admin Configuration
# ========================================
# If set, user registering with this email will automatically become SUPER_ADMIN
# If not set in PRODUCTION, registration will fail (security feature)
# 如果设置，使用此邮箱注册的用户将自动成为超级管理员
# ⚠️ PRODUCTION: Must be set, otherwise admin creation will fail
INITIAL_ADMIN_EMAIL="admin@your-domain.com"

# ========================================
# Email Configuration (SMTP)
# ========================================
# Recommended providers:
#   - Brevo (https://www.brevo.com/) - Free tier: 9000 emails/month
#   - SendGrid (https://sendgrid.com/) - Free tier: 100 emails/day
#   - Mailgun (https://www.mailgun.com/) - Free tier: 5000 emails/month
#
# For Brevo:
#   1. Sign up at https://www.brevo.com/
#   2. Go to: Settings > SMTP & API > SMTP
#   3. Copy your SMTP credentials
SMTP_HOST="smtp.your-provider.com"
SMTP_PORT="587"  # Use 587 for STARTTLS, 465 for SSL/TLS
# SMTP_SECURE should be empty for port 587 (STARTTLS), "true" only for port 465 (SSL)
SMTP_SECURE=""
SMTP_USER="your-smtp-username@domain.com"
SMTP_PASS="YOUR_SMTP_PASSWORD_OR_API_KEY"
SMTP_FROM_EMAIL="noreply@your-domain.com"
SMTP_FROM_NAME="Flotilla Team"

# ========================================
# Security Notes
# ========================================
# 1. ALL passwords/secrets should be at least 32 characters
# 2. Use environment-specific secrets (dev, staging, prod)
# 3. Rotate secrets regularly (every 90 days recommended)
# 4. Never commit .env files to version control
# 5. Use secret management tools in production (Vault, AWS Secrets Manager, etc.)
# 6. Enable 2FA/MFA for all service accounts
#
# Generate strong secrets:
#   openssl rand -base64 32   # For most secrets
#   openssl rand -base64 24   # For MeiliSearch (min 16 chars)
#   openssl rand -hex 32      # For hex-encoded secrets
# ========================================
