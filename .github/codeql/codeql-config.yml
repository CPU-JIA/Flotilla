# CodeQL 配置文件
# Phase 4 P4.5: 高级静态代码分析

name: "Flotilla Security CodeQL Config"

# 禁用默认查询
disable-default-queries: false

# 查询套件
queries:
  - uses: security-extended
  - uses: security-and-quality

# 自定义查询路径（可选）
# queries:
#   - name: Custom Security Queries
#     uses: ./.github/codeql/custom-queries

# 路径过滤器
paths:
  - apps/backend/src
  - apps/frontend/app
  - apps/frontend/components
  - website

# 排除路径
paths-ignore:
  - '**/node_modules/**'
  - '**/dist/**'
  - '**/build/**'
  - '**/.next/**'
  - '**/coverage/**'
  - '**/prisma/migrations/**'
  - '**/prisma/generated/**'
  - '**/*.spec.ts'
  - '**/*.test.ts'
  - '**/*.spec.tsx'
  - '**/*.test.tsx'
  - '**/*.config.js'
  - '**/*.config.ts'

# 查询过滤器
# 排除低严重性问题（仅关注 warning, error）
query-filters:
  - exclude:
      problem.severity: note
  - exclude:
      problem.severity: recommendation

# 运行配置
packs:
  # JavaScript/TypeScript 查询包
  javascript:
    - codeql/javascript-queries:codeql-suites/javascript-security-extended.qls
    - codeql/javascript-queries:codeql-suites/javascript-code-scanning.qls

# 外部配置（可选）
# 数据库配置
# database:
#   interpret-results:
#     max-paths: 4

# 分析器配置
# trap:
#   properties:
#     javascript:
#       # 增加超时时间（秒）
#       timeout: 600
